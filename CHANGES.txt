CHANGES.txt - 02/07/2001
------------------------

CHANGES IN CUPS V1.1.6-3

	- The configure script put the JPEG library before the
	  TIFF library; this caused problems in some
	  configurations since the TIFF library also supports
	  JPEG compression of TIFF images.
	- The updated cupsTempFile() function did not return
	  the filename when called with a filename buffer of
	  NULL (previously it used a static buffer.)
	- FreeBSD uses /dev/unlptN, but NetBSD and OpenBSD use
	  /dev/ulptN.
	- SuSE fix: Exit from child if setgid() or setuid()
	  fails.
	- SuSE fix: Added setgroups() calls after setgid() and
	  setuid() calls.


CHANGES IN CUPS V1.1.6-2

	- Added changes to support NetBSD startup scripts.
	- Added separate compiler options for pstoraster
	  (Ghostscript) to avoid compiler-induced errors
	  from Ghostscript's twisted code.
	- The mime.types file contained syntax errors.
	- Updated the *BSD USB device filenames to use
	  the /dev/unlptN files so that the USB device
	  is not reset prior to printing (causes print
	  corruption on many printers)
	- Added new cupsTempFd() function to avoid serious
	  security bug in glibc fopen() function.  The glibc
	  fopen() function unlinks a file before creating it,
	  which opens up possible symlink attacks.
	- Now reject 0-length names in add-printer and add-class
	  requests.
	- Fix for pstoraster when ZLIB is not available.
	- cupsGetPPD() didn't reconnect when a HTTP connection
	  was lost.
	- SuSE fix: httpConnect() didn't check that the
	  value from gethostbyname() was a valid IPv4 address.
	- SuSE fix: httpConnect() didn't allow file descriptor 0
	  to be used for a socket.
	- SuSE fix: ippRead() didn't confirm that all values in
	  a set were numeric or string types.
	- SuSE fix: lppasswd race condition fixes.
	- SuSE fix: directive names could overflow buffer when
	  reading *.conf files.
	- SuSE fix: HEAD requests for PPD files did not use the
	  same logic as GET requests.
	- SuSE fix: possible buffer overflow when adding
	  /index.html to requested directory name.
	- SuSE fix: possible buffer overflow when converting
	  IPP attributes to string options for filters.
	- SuSE fix: creating file: device output with mode 0666
	  instead of mode 0600.
	- SuSE fix: creating job info files with mode 0640
	  instead of 0600.
	- SuSE fix: don't rely on snprintf() for including
	  system name in log filenames.
	- SuSE fix: add bounds checking when copying quoted
	  and hex strings.


CHANGES IN CUPS V1.1.6-1

	- Added configure check for getting the correct
	  strftime() format string; %c is not Y2k safe,
	  and %KC and NULL are not universally supported.


CHANGES IN CUPS V1.1.6

	- Fixed another possible DoS attack in httpGets()
	- Added check for "LANGUAGE = PCL" and "LANGUAGE =
	  POSTSCRIPT" in mime.types.
	- Resolution options were not being passed into the
	  filter programs properly.
	- The default compiler options for GCC no longer include
	  "-g3", which apparently is deprecated in newer
	  versions of GCC.
	- CheckJobs() could cause cupsd to crash if a job is
	  cancelled in StartJob().
	- The printers.conf and classes.conf files are now
	  written with restricted permissions.
	- The round-robin algorithm used by FindAvailablePrinter()
	  had problems; fixes contributed by Joel Fredrikson.
	- If LoadAllJobs() is unable to determine the file type
	  of a print job, assume "application/vnd.cups-raw".
	- The web interface now provides a job_printer_name
	  value for any corresponding job_printer_uri value.
	- The cups-lpd mini-daemon now logs the client address
	  and hostname as well as all commands and errors in the
	  syslog file.
	- The IPP backend now detects the supported file formats
	  and only specifies the document format if it is
	  supported.  This makes IPP printing to network print
	  servers and cards more reliable without affecting the
	  capabilities of CUPS servers.
	- The time_at_xyz attributes are now converted to human-
	  readable dates and times for the web interfaces.
	- The HP and EPSON sample drivers now correctly catch
	  signals and eject the current page when a job is
	  cancelled.
	- Fixed bug in CGI code - did not ignore control
	  characters (e.g. newlines) in form data.  This caused
	  sporatic web interface problems.
	- The file type logging code in the scheduler referenced
	  the optional document-format attribute; the new code
	  uses the resolved MIME type instead.
	- The client.conf parsing code now removes trailing
	  whitespace.
	- The MaxJobs directive was being treated as a boolean
	  instead of an integer.
	- The scheduler would not timeout remote printers if
	  BrowseInterval was set to 0.
	- The lpadmin command now supports setting of options
	  and user-level access control.
	- Added "-E" option to all printing commands to force
	  encryption.
	- The client code did not consume the response to the
	  OPTIONS request when switching to secure mode.
	- The scheduler did not output a Content-Length field
	  when responding to an OPTIONS request.
	- Added documentation on using cups-lpd with xinetd
	  to the man page.
	- The socket backend now starts retries at 5 seconds and
	  increases the interval to 30 seconds.  This should
	  provide faster printing when multiple jobs/files are
	  queued for a printer.
	- The filters and backends no longer buffer output to
	  stderr.  This should provide much more accurate status
	  reporting.


CHANGES IN CUPS V1.1.5-2

	- Fixed configure check for OpenSSL to work with RSA
	  code.
	- Added configure check for <sys/ioctl.h>, and use this
	  check in backend/serial.c.
	- Updated configure script handling of data,
	  configuration, and state directories to use datadir,
	  sysconfdir, and localstatedir variables.
	- NetBSD uses different serial port filenames than
	  FreeBSD and OpenBSD.
	- The pdftops filter didn't need some X-specific files.
	- The scheduler makefile doesn't do a chown anymore when
	  installing (cupsd did this automatically on startup
	  anyways)


CHANGES IN CUPS V1.1.5-1

	- There was a typo in the top-level Makefile
	- The top-level Makefile did not install an init script
	  for run level 5. 
	- The configure script did not add the "crypto" library
	  when checking for the OpenSSL library. 
	- The OKIDATA PPD files were missing. 
	- The config.h.in file defined the wrong version number. 
	- The serial backend did not define "funky_hex" under *BSD. 
	- Updated the Visual C++ project files and some of the
	  CUPS API sources to compile under Windows again. 


CHANGES IN CUPS V1.1.5

	- Security updates - new default configuration does
	  not broadcast printer information and only allows
	  access from the local system.
	- EXPERIMENTAL encryption support - CUPS now optionally
	  supports TLS/SSL encryption via the OpenSSL library.
	- Documentation updates.
	- Makefile/configure script updates.
	- The RPM spec file didn't work out-of-the-box under
	  RedHat or Mandrake.
	- Minor code cleanup to remove extraneous compiler
	  warnings.
	- cupsTempFile() was using %p for the temporary
	  filename; this should have been %08x (just 8 digit
	  hex)
	- Deleting a printer with active print jobs would still
	  crash the server.
	- ippWrite() and ipp_write_file() didn't send the
	  correct value length for name-with-language and
	  text-with-language attributes.
	- Updated IPP code to support copied strings (that
	  should not be freed); this provides slightly more
	  efficient IPP server performance.
	- Updated PDF filter to Xpdf 0.91.
	- httpGets() could go into an infinite loop if a line
	  longer than the input buffer size was sent by a
	  client. This could be used in a Denial-of-Service
	  attack.
	- The lpstat and CUPS API functions now request only the
	  data required when getting the list of printer or
	  class information.  This should improve performance
	  with large numbers of printers on slower machines.
	- The scheduler was always enforcing the FilterLimit,
	  even if FilterLimit was set to 0.
	- Updated the Linux USB backend to support Mandrake's
	  /dev/usb/usblp# filenames.
	- The PRINTER and LPDEST environment variables did not
	  override the lpoptions default printer.
	- The PPD read functions incorrectly included trailing
	  characters (usually whitespace) after quoted string
	  attributes.
	- The multiple-document-handling attribute handling code
	  did not check for the correct value for collated
	  copies (separate-documents-uncollated-copies).
	- The EPSON driver did not work with OKIDATA printers in
	  EPSON emulation mode (needed change-emulation command)
	- The HP-GL/2 filter did not scale the plot properly in
	  scale mode 2.
	- Added PPD files for 9-pin and 24-pin OKIDATA printers.
	- The httpSeparate() function didn't handle passwords
	  that started with a number.
	- ippDelete() could free the character set string
	  multiple times in name-with-language and
	  text-with-language attributes.
	- The scheduler would access freed memory right after
	  freeing it (for debug messages); these parts of the
	  code have been reordered to avoid this situation
	  which was causing sporatic errors and crashes.
	- The ppdClose() function didn't free all of the strings
	  in the ppd_file_t structure.
	- The LoadAllJobs() function in the scheduler did not
	  close the spool directory.
	- Changed all sprintf's that use string formats to
	  snprintf's, even if the destination buffer is
	  larger than the source string(s); this protects
	  against buffer overflows caused outside of CUPS...
	- Changed all strcpy's to strncpy's between local and
	  global variables, even if the destination buffer is
	  larger than the source string; this protects
	  against buffer overflows caused outside of CUPS...
	- The CUPS certificate functions didn't use the
	  CUPS_SERVERROOT environment variable when set.
	- The directory services code was copying instead of
	  comparing the remote printer info, resulting in
	  unnecessary updates of the printer attributes for
	  remote printers.
	- Added new mime.types rules to allow automatic raw
	  printing of PCL and ESC/P files; PJL headers are
	  parsed to differentiate between PostScript and
	  PCL job files.  This should eliminate a lot of
	  the reports of SAMBA printing problems due to
	  the missing "-oraw" or "-l" options.
	- The mimeLoadType() function didn't handle the
          3-argument contains() function.
	- The LoadPPDs() function in the scheduler didn't
	  properly set the alloc_ppds variable or handle a PPD
	  database containing 0 printers.
	- The scheduler FindAvailablePrinter() function didn't
	  use the same queuing logic as the CheckJobs()
	  function.  This caused classes to stall if a remote
	  printer was always busy.
	- Jobs are now assigned to printers in a class
	  round-robin style.  This should prevent the first
	  server in the class from bearing the brunt of the
	  jobs.
	- The scheduler's LoadAllJobs() function didn't always
	  restore remote printers for queued jobs on startup.
	- The serial backend didn't support the higher baud
	  rates with the old termios interface. It now supports
	  57600 and 115200 baud.
	- The serial backend now supports different types of
	  flow control; previously it ignored the flow=XYZ
	  option in the device URI.
	- The serial backend now supports DTR/DSR flow control,
	  which is popular on dot-matrix printers (access with
	  "flow=dtrdsr" in the device URI)
	- Added new job-originating-host-name attribute for
	  jobs.  The new attribute provides the hostname or
	  IP address of the machine that submitted the job.
	- The set-job-attributes code no longer allows read-only
	  job attributes to be changed.
	- Expanded the click area for the navigation bar in the
	  web interface.
	- Updated the lp and cancel commands to support all of
	  the Solaris print options (some are simply ignored
	  since they do not map)
	- Updated the scheduler to limit the number of file
	  descriptors to the maximum select() set size.  This
          was causing problems on Solaris systems where the
          max FD count was increased beyond 1024.
	- The scheduler's LoadDevices() function was getting
	  interrupted by the SIGCHLD signal handler; now ignore
	  child signals while loading devices.
	- Added quota and allow/deny user support for printers
	  and classes.
	- Removed black/CMY adjustment code from the PS and
	  image file RIPs; it was interfering with some CUPS
	  driver dithering code.
	- The lpc program stopped listing the queue statuses
	  after the first active printer.
	- The cups-lpd program used an output format that the
	  Solaris printing system did not understand.
        - Updated the lpq program to use the Solaris format
	  except under Tru64 UNIX.
	- Some DEC PPD files incorrectly use "Off" for the null
	  value in UI constraints. Added "Off" to the list of
	  accepted null values.
	- Changed the *BSD define constants to __*BSD__ in all
	  of the backends.
	- Added support for "lpstat printername", which is an
	  undocumented feature in Solaris.
	- The HP-GL/2 filter now only sets the plot size if it
	  is set in the plot file.
	- The lpmove command wasn't sending the requesting
	  user name, causing it to always fail.
	- Updated the cupsTempFile() code to use GetTempPath()
	  under Windows.
	- The cups-lpd mini-daemon didn't limit the number of
	  data files accepted, didn't use cupsTempFile(),
	  didn't handle control file job information in any
	  order, and didn't free job options after printing
	  a file.
	- The scheduler copy_banner() function did not
	  explicitly set the owner and permissions of the banner
	  files, which could prevent the banner pages from
	  printing on some systems.
	- The lpstat program wasn't listing remote classes.
	- The scheduler did not verify that the printer-uri
	  attribute was specified in all requests that required
	  it.


CHANGES IN CUPS v1.1.4

	- Makefile and configure script fixes.
	- **** Changed the default Printcap setting **** to
	  /etc/printcap. There are just too many people asking
	  why application XYZ doesn't see their printers!
	- The web admin interface now displays an error if it
	  can't get the list of printer drivers from cupsd.
	- The IPP backend was putting the copies option before
	  the other job options were set. This caused the IPP
	  request to contain attribute groups in the wrong
	  order, which prevented remote printing.
	- Added checks in scheduler to free memory used for
	  IPP requests and language information when closing
	  a client connection.
	- Fixed the duplex option in the HP LaserJet driver.  It
	  should now work with all LaserJet printers (and
	  compatibles)
	- The add-printer web interface didn't initialize the
	  "old info" data pointer, which caused random crashes
	  on many OS's.
	- Fixed many page sizes defined in the Level 1
	  compatibility file "gs_statd.ps" to match reality.
	- Fixed another bug in the setpagedevice "code" in
	  Ghostscript.  It should now accept all standard
	  Adobe attributes on all platforms.
	- Fixed pstoraster so that it reallocates memory for
	  color depth changes as well as size/resolution
	  changes.  This removes an ordering constraint on
	  the color, page size, and resolution options in
	  PPD files.
	- The IPP backend didn't use the job's character set
	  when the destination printer supported it.  This
	  caused problems when printing text files to other
	  CUPS servers.
	- Updated the logic used to determine when to rebuild
	  the PPD file database.  The scheduler now checks the
	  dates and the number of PPD files (was just checking
	  the dates.)
	- Updated the ippSetCGIVars() function (used by the
	  web interfaces) to only filter valid string values.
	- The PostScript filter was scaling 2-up pages
	  incorrectly.  This caused the edges of some pages to
	  be clipped.


CHANGES IN CUPS v1.1.3

	- Makefile fixes.
	- RPM spec file changes.
	- Documentation updates.
	- Enabled pstoraster debug messages for everything
	  (only logged when LogLevel set to "debug"...)
	- Changed the Input/OutputAttributes fix in
	  pstoraster so that it works on all platforms.
	- The HP-GL/2 filter didn't set the right green
	  color value in encoded polylines or text.
	- Updated the "fitplot" code to handle plot sizes
	  specified as "PSwidth,length" and "PSlength,width".
	- Updated the Linux parallel and USB backends to open
	  the device files prior to looking in /proc for
	  autoprobe info. This makes sure that loadable device
	  driver modules are in fact loaded...
	- Added new FilterLimit directive to limit the number
	  of processing jobs/filters on a system.
	- set-job-attributes didn't change the job-state to
	  held/pending when the job-hold-until attribute was
	  specified.
	- set-job-attributes didn't save the new job attributes.
	- Now change the "requesting-user-name" attribute in
	  requests from remote systems to "remroot" when an
	  unauthenticated "root" user is sent. This can be
	  changed using the new RemoteRoot directive in
	  cupsd.conf.
	- The cancel-job, hold-job, release-job, and restart-job
	  operations didn't log the authenticated username.
	- The cups-lpd mini-daemon now checks for a
	  document-format option before forcing raw mode with
	  filter mode 'l'.
	- The cups-lpd mini-daemon now supports "-o" options
	  on the command-line (passed by inetd) to set global
	  defaults for all print queues.
	- The pstops filter assumed that a file with a Trailer
	  comment would also have an EOF comment.
	- Added new cupsSetPasswordCB(), cupsSetServer(),
	  cupsSetUser(), and ippSetPort() functions to better
	  support client applications (especially GUIs...)
	- The CUPS-add-class and CUPS-add-printer operations
	  didn't reset the printer-name attribute on remote
	  print queues that had to be renamed when a local
	  printer was defined with the same name.
	- The lpoptions command now supports a "-r" option to
	  remove options for a printer or instance.
	- The lpadmin and admin.cgi programs no longer allow
	  class and printer names to begin with a number; this
	  caused the command-line utilities to become confused.
	- The Linux USB backend now looks for both the parallel
	  and usblp driver names in the device list.
	- Added a new FontPath directive to cupsd.conf, and also
	  a "--with-fontpath" option for the configure script to
	  specify alternate font paths for pstoraster.
	- The CUPS-move-job operation didn't update the
	  job-printer-uri attribute.
	- The scheduler only looked up printers and classes by
	  name in IPP requests, instead of using the full URI.
	  This caused problems with KUPS and friends with
	  remote printers.
	- The scheduler now handles better localization of
	  hostnames (e.g. server is host.foo.com, remote is
	  host.subfoo.foo.com, localized is not host.subfoo...)
	- The scheduler logging functions now use a common
	  log file checking/rotation function (courtesy of
	  Crutcher Dunnavant at Red Hat)
	- The scheduler could accept more client connections
	  than it allocated for if more than one Port or Listen
	  line was present in cupsd.conf.
	- Other minor scheduler performance tweeks.
	- The lpq and lprm commands didn't support the default
	  printer set using lpoptions.
	- The lpoptions command now supports a "-l" option to
	  list the printer-specific options and their current
	  settings.
	- The web printer and class lists now show a link to the
	  default printer or class at the top of the page.
	- The text filter now supports pretty printing of shell
	  and perl scripts as well as C/C++ source files.
	- The top and bottom margins were reversed for landscape
	  text printing.
	- The lpq and lprm commands didn't understand printer
	  instances.
	- The scheduler only selected on the first 100 file
	  descriptors instead of the maximum file descriptor
	  limit.
	- The scheduler client, listener, and mainline functions
	  now share code to disable and enable monitoring for
	  new client connections.
	- The imagetoraster filter didn't support all of the
	  required pagedevice parameters.
	- The serial backend now checks for 100 serial ports
	  under Linux.
	- The scheduler used sscanf() to pull out the remote
	  printer location, description, and make/model strings,
	  but if any of these options was empty then sscanf()
	  would stop processing.
	- Added "debug2" log level to provide a little less
	  verbose debugging information at the "debug" level.
	- The scheduler would crash if you stopped a printer
	  that was currently printing a job.
	- The scheduler incorrectly allowed jobs in the cancelled,
	  aborted, or completed state to be cancelled.
	- The image filters did not load TIFF images properly
	  for bottom-to-top and right-to-left orientations.
	- Added new cupsEncodeOptions() function to encode
	  CUPS options as IPP job attributes.
	- The IPP backend, LPD mini-daemon, client commands,
	  and CUPS API did not properly encode multiple
	  option values separated by commas.
	- Added new scheduler malloc logging in debug mode
	  (provides summary of total arena size, allocated,
	   and free bytes once a minute)
	- The EPM-based distributions didn't install the
	  correct symlinks for a few man pages.
	- Fixed a memory leak in the scheduler - wasn't
	  freeing old filters when deleting or renaming
	  printers.
	- The scheduler now queries the primary IP address
	  for the name of the server and maps any incoming
	  requests from that address to the server name.
	  This fixes web admin mapping problems from
	  server.domain.com to localhost.
	- The web printer modify interface now remembers
	  the previous device and driver settings (except
	  for serial ports.)
	- The job-k-octets attribute is now stored as part of
	  the job attributes; this preserves the information
	  after a job is completed when job file history is
	  turned off.
	- Dropped option sub-group parsing code for the moment,
	  since many Xerox PPD files abuse this feature in PPD
	  files and don't follow the hierarchy rules.
	- Added new wrapper code around options so that duplex
	  options for some HP printers don't prevent prints.
	- Added support for Digital UNIX/Tru64 UNIX/OSF/1 format
	  for "lpstat -v" output.
	- Now show the URI for remote printers instead of
	  /dev/null in "lpstat -v" output.
	- Creating classes and adding printers to a class with
	  the lpadmin command didn't work.
	- The banner pages and test page should now format
	  correctly in both portrait and landscape orientations.
	- Updated banner page substitution so that { can appear
	  by itself without quoting.


CHANGES IN CUPS v1.1.2

	- Makefile/configure fixes
	- RPM spec file and EPM list file fixes
	- The cupsTempFile() function now uses a different
	  algorithm for generating temp files and "reserves"
	  them to avoid possible security exploitation.
	- Now use /dev/random (if available) to seed the random
	  number generator for certificates.
	- The /var/spool/cups and /var/spool/cups/tmp directories
	  were incorrectly owned by root; they are now owned by
	  the filter user, typically "lp".
	- The scheduler now resets the permissions on the spool
	  and temp directories as needed to match the filter
	  user.
	- Now expose ppdCollect() as an externally callable
	  function.
	- The image filters now support filtering from the
	  standard input.
	- The imagetoraster filter now collects all printer
	  options and job patch files and applies them to the
	  page header as needed.
	- Added format and banner options to LPD backend.
	- The send-document operation didn't start a job
	  immediately when last-document was true.
	- The set-job-attributes operation didn't correctly
	  replace the current job-hold-until value.
	- Removed the option wrapper code from ppdEmit() and
	  friends since it caused problems with Ghostscript
	  and many PS printers.
	- Was setting TZ environment variable twice for job
	  filters.
	- Added syslog logging in cups-lpd to aide in
	  debugging problems.
	- The HP-UX parallel port backend did not list the
	  available parallel ports on some systems (printf
	  calling problem...)
	- The lp and lpr commands overrode user options if
	  -d/-P were specified after -o.
	- The scheduler would crash with a */* filter.
	- Added support for a "default" filter for unknown file
	  types.  The example provided in the mime.types and
	  mime.convs file prints unknown files as if "-oraw" was
	  specified for the job.  This functionality is disabled
	  by default.
	- The "compatibility" mode fix for older backends did not
	  work for smbspool.  Added a workaround for it.
	- The HP-GL/2 filter didn't perform the right pen scaling
	  with some files and the "fitplot" option.
	- New Software Performance Specification document that
	  describes the memory, disk, and CPU usage of all the
	  CUPS software.


CHANGES IN CUPS v1.1.1

	- The pstoraster Makefile still referenced one of the
	  old PDF filter files.
	- The filter Makefile used INSTALL_DATA instead of
	  INSTALL_LIB to install the CUPS image library.
	- The administration CGI didn't work properly with
	  network devices.
	- The BrowseACL variable was not updated after the
	  cupsd.conf file was loaded.
	- The lpd mini-daemon didn't support printer instances.
	- Now use a default umask of 077 for child processes.
	- Now put temp files in /var/spool/cups/tmp for child
	  processes and the root user, unless TMPDIR or TempDir
	  is defined otherwise.
	- cupsGetPPD() no longer uses easy-to-guess filenames.
	- The CUPS-Delete-Class and CUPS-Delete-Printer
	  operations now save classes.conf file as needed.
	- The lppasswd command wouldn't add a user.
	- The ppdOpen() function could cause a segfault if a
	  0-length PPD file was read.
	- The image filters were not handling images with
	  different X and Y resolutions properly.
	- The imagetoraster filter defaulted to RGB output
	  instead of black output like pstoraster.
	- The pstops filter didn't handle binary data properly.
	- The pstops filter didn't handle copies properly for
	  PS files lacking DSC comments.
	- The pstops filter now appends %%EOF to the end of
	  documents if they don't have it.
	- The cupsGetPPD() function didn't work with remote
	  printers lacking the @server in the name.
	- The configure script didn't work right when only
	  --prefix was specified.
	- The ppdEmit() code now wraps all printer commands so
	  that buggy PostScript printers will still print a file
	  after receiving an option that isn't available.
	- Fixed the DeskJet margin bug, and disabled 600dpi
	  color mode until it can be fixed.
	- The cupsAddDest() function didn't sort instances
	  correctly in all cases.
	- The time-at-xyz attributes now expand to the date and
	  time in banner files.


CHANGES IN CUPS v1.1

	- Documentation updates.
	- Configuration script updates.
	- Didn't map charset and language value strings to lowercase
	  and _ to - as required by SLP and IPP.
	- ppdLoadXYZ() didn't add the list of available fonts to the
	  ppd_file_t structure.
	- The text filter common code was freeing the PPD file data
	  before it was used.
	- The text filter now embeds missing fonts.
	- The CGI interface now maps local access to the server to
	  the localhost address.
	- The HP-GL/2 filter didn't use the specified (or default)
	  color ranges, resulting in strange colors.
	- The HP-GL/2 filter didn't default to no input window, which
	  caused unnecessary clipping of plots.
	- Integrated Xpdf's pdftops filter into CUPS, which is a
	  lightweight and reliable replacement for Ghostscript's
	  PDF support.
	- Removed all PDF support from Ghostscript.
	- Updated HP driver to set top margin; this seems to fix
	  the offset problem seen on HP DeskJet printers.
	- Fixed dependencies on the ZLIB and JPEG libraries in
	  pstoraster.
	- The lpr command wasn't using the lpoptions defined by
	  the user.
	- The lpr command would segfault if the CUPS server was
	  not running.
	- The top-level makefile was not installing the CUPS
	  initialization script.  It now does so if it sees there
	  is an init.d directory in /sbin, /etc/rc.d, or /etc.
	- "lpstat -v all" didn't work.
	- pstoraster would crash on some platforms doing the
	  setpagedevice operator.
	- The web administration interface now allows you to set
	  the default banner pages.
	- Images can now be positioned on the page using the new
	  "position" option.
	- The AccessLog, ErrorLog, and PageLog directives now
	  support "%s" to insert the server name.
	- Added a new BrowseShortNames directive to allow for
	  short remote printer names ("printer" instead of
	  "printer@server") when possible.
	- The scheduler could crash if given an invalid PPD file
	  with no PageSize attributes.
	- Updated the serial, parallel, and usb backends to do
	  multiple writes and ignore ioctl() errors as needed;
	  this should fix problems with serial printing on old
	  serial drivers and with the UltraSPARC parallel port
	  driver under Solaris 2.7.
	- Now propagate LD_LIBRARY_PATH to child processes from
	  cupsd.
	- New DataDir directive for installing in alternate
	  locations.
	- New CUPS_SERVERROOT and CUPS_DATADIR environment
	  variables to specify installation directories as
	  needed.
	- Queued remote jobs recreate remote printers as needed
	  when the scheduler is started.
	- Deleting a printer also purges all jobs on that
	  printer.
	- Old job and control files that don't belong to a
	  printer are automatically deleted.
	- Wasn't updating time-at-processing and
	  time-at-completed attributes in job.
	- Didn't send required multiple-operation-time-out
	  attribute in response to a get-printer-attributes
	  request.
	- cups-lpd now supports options set with lpoptions.
	- The job-hold-until attribute is now provided with all
	  jobs. For jobs that are not currently held the value
	  is "no-hold".
	- The scheduler was not sending "unknown" values in IPP
	  responses.
	- The lpoptions command now accumulates options from
	  previous runs rather than replacing all options for a
	  printer.
	- The IPP backend now switches to IPP/1.0 if a 1.1
	  request fails.
	- The lpadmin and admin.cgi programs now validate new
	  printer and class names.
	- The access_log file now includes the number of IPP bytes
	  received in a POST request.


CHANGES IN CUPS v1.1b5

	- Documentation updates.
	- The pstoraster filter didn't compile without the JPEG library.
	- The cupsd server didn't support the HTTP OPTIONS request
	  method.
	- Dropped the "CLOSE" method supported by the cupsd server.
	  (not defined in HTTP specification)
	- Makefile/configure script fixes.
	- Missing the job-restart template.
	- Added IPP test suite for testing.
	- Missing IPP documentation from binary distributions.
	- Fixed multiple-document handling code when last-document
	  not specified.
	- Added more checks to IPP requests to prevent bad requests
	  from getting through.
	- Not all of the Ghostscript error output was being sent to
	  stderr.
	- The PostScript filter now added PJL commands to set the
	  job name and display string, if supported.
	- The scheduler would crash if the browse socket could not
	  be bound. Now disables browsing if port 631 (reserved for
	  IPP) is being used by a misbehaving daemon.
	- The USB backend now looks for the older Linux 2.2.x USB
	  printer device filenames as well as the newer ones.
	- The IPP backend now uses the UTF-8 charset exclusively,
	  since apparently only CUPS handles more than US-ASCII and
	  UTF-8...
	- Wasn't quoting ( in PostScript banners...
	- Send-document requests with no document-format attribute
	  could cause cupsd to crash.
	- Old jobs in the spool directory might cause cupsd to
	  crash.
	- CUPS now supports all of the recommended job-hold-until
	  keywords as well as name values of the form "HH:MM" and
	  "HH:MM:SS".
	- Added placeholder pointer for TLS encryption to the HTTP
	  connection structure.
	- Fixed the "fast poll" bug reported by DISA - the
	  status pipe wasn't being closed for multi-file jobs.
	- Revamped put_params code in pstoraster to fix bitmap
	  allocation bug with FrameMaker output.
	- Ripped out filename, etc. code from pstoraster as it
	  is a potential security hole.
	- Added support for RIP_CACHE environment variable in the
	  new pstoraster.
	- Fixed USB device filenames for Linux; now support new
	  pre-2.4 devices (/dev/usb/lp#) and 2.2 devices
	  (/dev/usblp#)
	- Fixed accept-jobs crash with classes.
	- Didn't include dot-matrix EPSON drivers in previous
	  release.


CHANGES IN CUPS v1.1b4

	- Documentation updates.
	- Many makefile and configuration script fixes (should
	  now compile better under *BSD.)
	- The MediaPosition attribute was being mishandled by
	  GhostScript, causing the RIP to fail whenever a paper
	  tray was selected.
	- The scheduler now logs the final line of log information
	  from a filter, even if it doesn't end with a newline; this
	  primarily affects GhostScript error output.
	- The scheduler was saving implicit classes, so after a few
	  restarts you'll end up with AnyPrinter, AnyAnyPrinter, etc.
	- The JPEG autodetection didn't work with some JPEG files that
	  came from digital cameras (JPEG but not JFIF); the new
	  magic types should work with all images that the JPEG library
	  can handle.
	- Fixed a bug in the new contains() MIME type rule that could
	  cause cupsd to crash.
	- Switched to using strtol() in the MIME type code so that you
	  can use hex, octal, or decimal constants as desired in the
	  mime.types file.
	- Banner files are now treated as templates, allowing any type
	  of file to be used as a banner.
	- Added a 30-second timeout to backend device reports so that a
	  hung backend will not prevent the scheduler from starting.
	- Backends are once again terminated when jobs are stopped; the
	  CUPS-supplied backends will stay alive until the downstream
	  filters have had a chance to clear out old page data.
	- The charset lookup in the CUPS localization support was wrong
	  (iso8859-x instead of iso-8859-x)
	- Changed the "cpNNNN" code page files to "windows-NNNN" to match
	  the IANA registrations.
	- New PostScript banner pages.
	- Added Windows BMP and Alias PIX image file support to the image
	  filter.
	- The PNG reading coded didn't free all of its buffers.
	- Added Digest authentication support to the client and server
	  code.
	- Added Solaris options to System V commands.
	- Now support the output-bin job template attribute.
	- Now log the job-billing attribute in the page_log file, and
	  keep track of the total number of pages in the
	  job-media-sheets-completed attribute.
	- The penwidth option is now in micrometers to support more
	  accurate width specification.
	- The image filters now support interlaced and transparent PNG
	  files.
	- Didn't handle Keep-Alive for HTTP/1.0 clients.
	- The BrowsePoll support didn't handle when BrowseInterval
	  was set to 0 (now uses 30 seconds if BrowseInterval is 0)
	- The DeskJet driver now supports 600 DPI color for printers
	  that support it.
	- New lpinfo and lpmove commands.
	- The lpq command now supports the Digital UNIX output format.
	- The LPD mini-daemon now supports all required LPD operations.
	- Implemented timeouts for multi-file documents.
	- New cupsPrintFiles() function in the CUPS API library to
	  print multiple files using create-job and send-document
	  requests (1 job ID for multiple files)
	- The lp command now sends multiple files as a single job,
	  matching the behavior of the System V command.
	- The "cancel -a" command now purges job history files.


CHANGES IN CUPS v1.1b3

	- Documentation updates.
	- The startup script redirected stderr before stdout,
	  which caused problems with some versions of Bourne
	  shell and Bash.
	- Fixed a bug in the scheduler's PPD language reading
	  code.
	- Fixed a bug in the scheduler's check for the
	  manufacturer in the PPD.
	- The pstoraster filter didn't allow some input and
	  output attributes to be set.
	- Added banner page support.
	- Added missing PAM configuration file.
	- Configuration script fixes for Linux and *BSD.
	- The log file code was using the wrong sign for the
	  timezone offset.
	- The default printcap file is now empty (no printcap
	  file is generated).
	- The scheduler did not start jobs destined for remote
	  printers when they became available.
	- The scheduler now sends jobs to remote printers
	  immediately. (when sending jobs to a class, the remote
	  printer is only used when it becomes available)
	- The scheduler now supports printing of banner pages
	  via the job-sheets attribute (banner files go in
	  /usr/share/cups/banners)
	- The cupsd process now forks itself into the background
	  (override with -f)
	- Added several *BSD enhancements.
	- Added UNSUPPORTED libtool option to configuration
	  script to allow the use of libtool.  Note that this is
	  UNSUPPORTED by us, but added by request of the *BSD
	  folks.
	- The parallel, serial, and usb backends now retry the
	  opening of their ports.  This allows multiple print
	  queues to be associated with a single physical port,
	  and will allow CUPS to support several types of
	  parallel port auto-switches in the near future.
	- Set-Job-Attributes now supports adding, changing, and
	  deleting job template attributes, and no longer allows
	  job-printer-uri to be set (see CUPS-Move-Job)
	- Added CUPS-Move-Job operation to support moving of jobs.
	- The CGI template functionality now supports multiple
	  languages (still only have templates for English)
	- The CUPS-Get-Printers and CUPS-Get-Classes operations
	  now support filtering as defined in the IDD.
	- The Get-Jobs, CUPS-Get-Printers, and CUPS-Get-Classes
	  operations no longer limit themselves to 1000 jobs,
	  printers, or classes (believe it or not, this is
	  needed for some sites)
	- The web interfaces now support language-specific
	  templates.
	- The web admin interface now supports class management.
	- The web admin interface now shows a list of
	  manufacturers before selecting the PPD/driver for a
	  specific printer.
	- The web admin interface now supports configuration of
	  the default printer options in the PPD file.
	- The web interface now uses printer/class
	  authentication for the test page instead of admin
	  authentication.
	- Updated the RPM spec file for the current release.
	- Updated language support for Windows code pages.
	- 8-bit character set files can now use multiple fonts
	  (needed for Arabic, Greek, Hebrew, etc.)
	- Added basic right-to-left text support in the text
	  filter.
	- The POSIX locale now uses ISO-8859-1 instead of
	  US-ASCII.
	- Fixed PDF printing problems.
	- Fixed PostScript RIP page device dictionary elements
	  that weren't getting passed in cups_get_params().
	- Added a new "contains" rule for the magic file typing.
	- The "printable" rule now accepts characters from 128 to 255
	  (needed for Microsoft character sets)
	- Added support for ~/.cupsrc as well as /etc/cups/client.conf
	  so that the default server can be configured on a per-user
	  basis without environment variables.
	- Added LPD mini-daemon to support incoming LPD jobs.


CHANGES IN CUPS v1.1b2

	- Documentation updates.
	- The lp command didn't always load the user-defined
	  destinations, preventing it from seeing the default
	  printer.
	- Many configure script and makefile fixes.
	- The Microsoft code page files were missing from the
	  distribution.
	- Added a workaround for the HP IPP client (which is sending
	  an invalid printer-uri in requests)
	- Fixed the encoding of text-with-language and name-with-language
	  to match the IPP spec.
	- Added support for unknown value tags in the IPP routines
	  (previously they would be ignored)
	- Integrated GNU GhostScript 5.50 into the pstoraster filter.
	- Client hostname resolution was broken on little-endian
	  machines.
	- Now look at client.conf file for client's default server
	  and printer.
	- The cupsServer() function did not close the client.conf file
	  if it contained a ServerName directive.
	- Added BrowseAllow, BrowseDeny, BrowseOrder, BrowsePoll, and
	  BrowseRelay directives.
	- BrowseInterval 0 disables advertising of local printers, but
	  still receives information on remote printers.
	- New browse polling daemon (for polling servers on different
	  networks)
	- New PPD cache file for faster startup times with large numbers
	  of PPD files.
	- The Host: field was incorrectly required for HTTP/1.0 clients.
	- New set-job-attributes operation now supported.
	- The mime_load_types() and mime_load_convs() functions did not
	  close their input files.


CHANGES IN CUPS v1.1b1

	- NEW web-based administration interface.
	- NEW EPSON printer drivers.
	- NEW user-defined printers and options.
	- NEW persistent jobs and job history
	- NEW IPP/1.1 support
	- NEW template-based web interfaces.
	- NEW CUPS-get-devices and CUPS-get-ppds operations.
	- NEW support for create-job and send-file operations.
	- NEW certificate-based authentication for local
	      administration.
	- NEW USB backend.
	- The lpr command now produces human-readable error messages.
	- The lpq command now produces BSD standard format output
	  instead of OSF/1 output.  This should resolve the SAMBA
	  print queue problems that have been reported.
	- The IPP backend did not always detect when the "raw" option
	  was being used.
	- The "lpstat -p" command would stop after the first active
	  printer.
	- The "lpstat -v" command would stop before the first remote
	  printer.


CHANGES IN CUPS v1.0.5

	- The HP-GL/2 filter did not correctly set the pen color
          for pens other than #1.
	- The scheduler would only accept 26 simultaneous jobs
          under some OS releases (mkstemp() limitation.)  It now
          handles up to 2^32 simultaneous jobs.
	- The PostScript filter loaded the printer's PPD file
          twice.
	- The PAM authentication code now uses pam_strerror() to
          provide a textual error message in the error_log file.
	- The scheduler now copies PPD and interface script
          files instead of moving them; this fixes installations
          with a separate requests directory.
	- The PostScript RIP did not generate correct 6-color
          output.
	- Several filters were marking PPD options twice when
          they didn't need to.
	- The scheduler did not save the printer or class state
          after an accept-jobs or reject-jobs operation.
	- The cupsGetDefault() function now ignores the PRINTER
          environment variable if it is set to "lp".
	- New ippErrorString() function to get textual error
          messages.
	- Better error reporting in the System V commands.
	- The lpadmin and lpstat commands always tried to
          connect to the default server.
	- The text filter didn't load the charset files from the
          correct location.
	- Wasn't sending a WWW-Authenticate: field to HTTP
          clients when authentication was required.
	- httpSeparate() didn't always set the default port
          number for known methods.
	- The HP-GL/2 filter now looks for "PSwidth,length"
          instead of (the correct) "PSlength,width" as
          documented by HP.  It appears that many major CAD
          applications are broken and this change allows the
          auto-rotation to work with them.
	- The IPP "printer-resolution" option was not being
          translated.
	- The charset files did not include the Microsoft
          "standard" characters from 128 to 159 (unused by the
          ISO-8859-x charsets)
	- The scheduler was chunking the Content-Type field from
          CGI programs; this problem was most noticeable with
          Microsoft Internet Explorer 5.
	- By popular demand, the printers, jobs, and classes
          CGIs no longer force a reload of the page every 10/30
          seconds.
	- The scheduler incorrectly required that the IPP client
          provide a document-format attribute for the
          validate-job operation.
	- Clients that sent bad IPP requests without the
          required attributes-natural-language and
          attributes-charset attributes would crash the
          scheduler.


CHANGES IN CUPS v1.0.4

	- Documentation updates.
	- Jobs would get stuck in the queue and wouldn't print
	  until you enabled the queue.
	- The lp and lpr commands now catch SIGHUP and SIGINTR.
	- The lp and lpr commands now use sigaction or sigset
	  when available.
	- CUPS library updates for WIN32/OS-2


CHANGES IN CUPS v1.0.3

	- Documentation updates.
	- The lpq man page was missing.
	- The configure script was not properly detecting the
	  image libraries.
	- The top-level makefile was calling "make" instead of
	  "$(MAKE)".
	- PostScript filter fixes for number-up, OutputOrder,
	  and %Trailer.
	- The imagetops filter didn't end the base-85 encoding
	  properly if the image data was not a multiple of 4
	  bytes in length.
	- The imagetoraster filter didn't generate good banded
	  RGB or CMY data (was dividing the line width by 4
	  instead of 3...)
	- The imagetoraster filter now records the bounding
	  box of the image on the page.
	- The CUPS image library cache code wasn't working as
	  designed; images larger than the maximum RIP cache
	  would eventually thrash using the same cache tile.
	- The CUPS image library TIFF loading code didn't
	  handle unknown resolution units properly; the fixed
	  code uses a default resolution of 128 PPI.
	- cupsGetClasses() and cupsGetPrinters() did not free
	  existing strings if they ran out of memory.
	- The scheduler logs incorrectly contained 3 digits for
	  the timezone offset instead of 4.
	- The scheduler now does a lookup for the default user
	  and group ID; the previous hardcoded values caused
	  problems with the LPD backend.
	- The cancel-job operation now allows any user in the
	  system group to cancel any job.
	- The cancel-job operation stopped the print queue if
	  the job was being printed.
	- Now only stop printers if the backend fails. If the
	  filter fails then the failure is noted in the
	  error_log and printing continues with the next file in
	  the queue.
	- Now log whether a filter fails because of a signal
	  or because it returned a non-zero exit status.
	- The root user now always passes the system group test.
	- Printers with an interface script and remote printers
	  and classes didn't have a printer-make-and-model
	  attribute.
	- Added logging of lost/timed-out remote printers.
	- The HP-GL/2 filter was scaling the pen width twice.
	- Updated the HP-GL/2 filter to use a single SP (Set
	  Pen) procedure.  This makes the output smaller and is
	  more appropriate since the filter keeps track of the
	  pen states already.
	- The scheduler didn't handle passwords with spaces.
	- The IPP backend now does multiple copies and retries
	  if the destination server requires it (e.g. HP
	  JetDirect.)
	- The disable command didn't implement the "-c" option
	  (cancel all jobs.)
	- Changed the CMYK generation function for the image file
	  and PostScript RIPs.
	- The lp command didn't support the "-h" option as
	  documented.
	- The AppSocket, IPP, and LPD backends now retry on all
	  network errors.  This should prevent stopped queues
	  caused by a printer being disconnected from the
	  network or powered off.
	- The scheduler now restarts a job if the corresponding
	  printer is modified.
	- The image RIPs now rotate the image if needed to fit
	  on the page.


CHANGES IN CUPS v1.0.2

	- The HP-GL/2 filter didn't always scale the output
	  correctly.
	- The HP-GL/2 filter now supports changing the page size
	  automatically when the "fitplot" option is not used.
	- The cancel-job operation was expecting a resource name
	  of the form "/job/#" instead of "/jobs/#"; this
	  prevented the cancel and lprm commands from working.
	- The backends didn't log pages when files were printed
	  using the "-oraw" option.
	- The authorization code did not work with the Slackware
	  long shadow password package because its crypt() can
	  return NULL.
	- The chunking code didn't work for reading the response
	  of a POST request.
	- cupsGetPPD() now does authentication as needed.
	- The N-up code in the PostScript filter didn't work
	  with some printers (grestoreall would restore the
	  default blank page and device settings).
	- The N-up code in the PostScript filter didn't scale
	  the pages to fit within the imageable area of the
	  page.
	- Wasn't doing an fchown() on the request files.  This
	  caused problems when the default root account group
	  and CUPS group were not the same.


CHANGES IN CUPS v1.0.1

	- Documentation updates.
	- Fixed a bunch of possible buffer-overflow conditions.
	- The scheduler now supports authentication using PAM.
	- Updated the Italian message file.
	- httpEncode64() didn't add an extra "=" if there was
	  only one byte in the last three-byte group.
	- Now drop any trailing character set from the locale
	  string (e.g. "en_US.ISO_8859-1" becomes "en_US")
	- Fixed "timezone" vs "tm_gmtoff" usage for BSD-based
	  operating systems.
	- Updated IPP security so that "get" operations can be
	  done from any resource name; this allows the CGIs to
	  work with printer authentication enabled so long as
	  authentication isn't turned on for the whole "site".
	- The IPP code didn't properly handle the "unsupported"
	  group; this caused problems with the HP JetDirect since
	  it doesn't seem to support the "copies" attribute.
	- The HTTP chunking code was missing a CR LF pair at the
	  end of a 0-length chunk.
	- The httpSeparate() function didn't handle embedded
	  usernames and passwords in the URI properly.
	- Doing "lpadmin -p printer -E" didn't restart printing
	  if there were pending jobs.
	- The cancel-job operation now requires either a
	  requesting-user-name attribute or an authenticated
	  username.
	- The add-printer code did not report errors if the
	  interface script or PPD file could not be renamed.
	- Request files are now created without world read
	  permissions.
	- Added a cupsLastError() function to the CUPS API to
	  retrieve the IPP error code from the last request.
	- Options are now case-insensitive.
	- The lpq command now provides 10 characters for the
	  username instead of the original (Berkeley standard)
	  7.
	- The cancel command needed a local CUPS server to work
	  (or the appropriate ServerName in cupsd.conf)
	- The cancel and lprm commands didn't report the IPP
	  error if the job could not be cancelled.
	- The lp and lpr commands didn't intercept SIGTERM to
	  remove temporary files when printing from stdin.
	- The lp and lpr commands didn't report the IPP error if
	  the job could not be printed.
