<HTML>
<HEAD>
<TITLE>DRAFT - CUPS Software Security Report</TITLE>
<META NAME="AUTHOR" CONTENT="Easy Software Products">
<META NAME="COPYRIGHT" CONTENT="Copyright 1997-1999, All Rights Reserved">
<META NAME="DOCNUMBER" CONTENT="CUPS-SSR-1.0">
</HEAD>
<BODY>
<CENTER><A HREF=#contents><IMG SRC="images/cups-large.gif" BORDER=0><BR>
<H1>DRAFT - CUPS Software Security Report</H1></A><BR>
CUPS-SSR-1.0<BR>
Easy Software Products<BR>
Copyright 1997-1999, All Rights Reserved<BR>
</CENTER>
<HR>
<H1 ALIGN=CENTER><A NAME=CONTENTS>Table of Contents</A></H1>
<BR>
<BR><B><A HREF=#1>1 Scope</A></B>
<UL>
<LI><A HREF=#1_1>1.1 Identification</A></LI>
<LI><A HREF=#1_2>1.2 System Overview</A></LI>
<LI><A HREF=#1_3>1.3 Document Overview</A></LI>
</UL>
<B><A HREF=#2>2 References</A></B>
<UL>
<LI><A HREF=#2_1>2.1 CUPS Documentation</A></LI>
<LI><A HREF=#2_2>2.2 Other Documents</A></LI>
</UL>
<B><A HREF=#3>3 3 - Local Access Risks</A></B>
<UL>
<LI><A HREF=#3_1>3.1 Security Breaches</A></LI>
<UL>
<LI><A HREF=#4_0_1>4.0.1 Denial of Service Attacks</A></LI>
<LI><A HREF=#4_0_2>4.0.2 Security Breaches</A></LI>
</UL>
</UL>
<B><A HREF=#4>4 4 - Remote Access Risks</A></B><B><A HREF=#5>A Glossary</A>
</B>
<UL>
<LI><A HREF=#5_1>A.1 Terms</A></LI>
<LI><A HREF=#5_2>A.2 Acronyms</A></LI>
</UL>
<HR>
<H1><A NAME=1>1 Scope</A></H1>
<H2><A NAME=1_1>1.1 Identification</A></H2>
 This software security report provides an analysis of possible 
security concerns for the Common UNIX Printing System (&quot;CUPS&quot;) Version 
1.0.
<H2><A NAME=1_2>1.2 System Overview</A></H2>
 The Common UNIX Printing System provides a portable printing layer for 
 UNIX&reg; operating systems. It has been developed by Easy Software 
 Products to promote a standard printing solution for all UNIX vendors 
 and users. CUPS provides the System V and Berkeley command-line 
interfaces. 
<P>CUPS uses the Internet Printing Protocol (IETF-IPP) as the basis for 
managing print jobs and queues. The Line Printer Daemon (LPD, RFC1179), 
Server Message Block (SMB), and AppSocket protocols are also supported 
with reduced functionality. </P>
<P>CUPS adds network printer browsing and PostScript Printer 
Description (&quot;PPD&quot;)-based printing options to support real world 
applications under UNIX. </P>
<P>CUPS also includes a customized version of GNU GhostScript 
(currently based off GNU GhostScript 4.03) and an image file RIP that 
can be used to support non-PostScript printers. </P>
<H2><A NAME=1_3>1.3 Document Overview</A></H2>
<P>This software security report is organized into the following 
sections:</P>
<UL>
<LI>1 - Scope</LI>
<LI>2 - References</LI>
<LI>3 - Local Access Risks</LI>
<LI>4 - Remote Access Risks</LI>
<LI>A - Glossary</LI>
</UL>
<H1><A NAME=2>2 References</A></H1>
<H2><A NAME=2_1>2.1 CUPS Documentation</A></H2>
 The following CUPS documentation is referenced by this document: 
<UL>
<LI>CUPS-CMP-1.0: CUPS Configuration Management Plan </LI>
<LI>CUPS-IDD-1.0: CUPS System Interface Design Description </LI>
<LI>CUPS-SAM-1.0.x: CUPS Software Administrators Manual </LI>
<LI>CUPS-SDD-1.0: CUPS Software Design Description </LI>
<LI>CUPS-SPM-1.0: CUPS Software Programming Manual </LI>
<LI>CUPS-SSR-1.0: CUPS Software Security Report </LI>
<LI>CUPS-STP-1.0: CUPS Software Test Plan </LI>
<LI>CUPS-SUM-1.0.x: CUPS Software Users Manual </LI>
<LI>CUPS-SVD-1.0.x: CUPS Software Version Description </LI>
</UL>
<H2><A NAME=2_2>2.2 Other Documents</A></H2>
 The following non-CUPS documents are referenced by this document: 
<UL>
<LI>IEEE 1387.4, System Administration: Printing (draft) </LI>
<LI>IPP/1.0: Additional Optional Operations - Set 1 </LI>
<LI>IPP/1.0: Encoding and Transport </LI>
<LI>IPP/1.0: Implementers Guide </LI>
<LI>IPP/1.0: Model and Semantics </LI>
<LI>RFC 1179, Line Printer Daemon Protocol </LI>
</UL>
<H1><A NAME=3>3 3 - Local Access Risks</A></H1>
<P>Local access risks are those that can be exploited only with a local 
user account. This section does not address issues related to 
dissemination of the root password or other security issues associated 
with the UNIX operating system. </P>
<H2><A NAME=3_1>3.1 Security Breaches</A></H2>
<P>Since the default installation creates a world-readable request 
directory, it is possible for local users to read the contents of print 
files before they are printed. </P>
<P>This problem can be alleviated by making the request directory 
readable only by the user specified in the CUPS configuration file. </P>
<H1><A NAME=4>4 4 - Remote Access Risks</A></H1>
<P>Remote access risks are those that can be exploited without a local 
user account and/or from a remote system. This section does not address 
issues related to network or firewall security. </P>
<H3><A NAME=4_0_1>4.0.1 Denial of Service Attacks</A></H3>
<P>Like all internet services, the CUPS server is vulnerable to denial 
of service attacks, including: </P>
<OL>
<LI>Establishing multiple connections to the server until the server 
 will accept no more. 
<P>This cannot be protected against by the current software. It  is 
possible that future versions of the CUPS software could be  configured 
to limit the number of connections allowed from a  single host, however 
that still would not prevent a determined  attack. </P>
</LI>
<LI>Repeatedly opening and closing connections to the server as fast 
 as possible. 
<P>There is no easy way of protecting against this in the CUPS 
 software. If the attack is coming from outside the local  network it 
might be possible to filter such an attack, however  once the 
connection request has been received by the server it  must at least 
accept the connection to find out who is  connecting. </P>
</LI>
<LI>Flooding the network with broadcast packets on port 631. 
<P>It might be possible to disable browsing if this condition  is 
detected by the CUPS software, however if there are large  numbers of 
printers available on the network such an algorithm  might think that 
an attack was occurring when instead a valid  update was being 
received. </P>
</LI>
<LI>Sending partial IPP requests; specifically, sending part of an 
 attribute value and then stopping transmission. 
<P>The current code is structured to read and write the IPP  request 
data on-the-fly, so there is no easy way to protect  against this for 
large attribute values. </P>
</LI>
<LI>Sending large/long print jobs to printers, preventing other users 
 from printing. 
<P>There are limited facilities for protecting against large print 
 jobs (the <CODE>MaxRequestSize</CODE> attribute), however this will 
 not protect printers from malicious users and print files that 
 generate hundreds or thousands of pages. In general, we recommend 
 restricting printer access to known hosts or networks, and adding 
 user-level access control as needed for expensive printers. </P>
</LI>
</OL>
<H3><A NAME=4_0_2>4.0.2 Security Breaches</A></H3>
<P>The current CUPS server only supports Basic authentication with 
usernames and passwords. This essentially places the clear text of the 
username and password on the network. Since CUPS uses the UNIX username 
and password account information, the authentication information could 
be used to gain access to accounts (possibly priviledged accounts) on 
the server. </P>
<P>The default CUPS configuration disables remote administration. We do 
not recommend that remote administration be enabled for all hosts, 
however if you have a trusted network or subnet access can be 
restricted accordingly. </P>
<P>The next minor release of CUPS will support Digest authentication of 
the entire message body using separate MD5-based username and password 
files. This will protect password information and prevent unauthorized 
access due to compromised account passwords. </P>
<H1 TYPE=A VALUE=1><A NAME=5>A Glossary</A></H1>
<H2><A NAME=5_1>A.1 Terms</A></H2>
<DL>
<DT>C </DT>
<DD>A computer language. </DD>
<DT>parallel </DT>
<DD>Sending or receiving data more than 1 bit at a time. </DD>
<DT>pipe </DT>
<DD>A one-way communications channel between two programs. </DD>
<DT>serial </DT>
<DD>Sending or receiving data 1 bit at a time. </DD>
<DT>socket </DT>
<DD>A two-way network communications channel. </DD>
</DL>
<H2><A NAME=5_2>A.2 Acronyms</A></H2>
<DL>
<DT>ASCII </DT>
<DD>American Standard Code for Information Interchange </DD>
<DT>CUPS </DT>
<DD>Common UNIX Printing System </DD>
<DT>ESC/P </DT>
<DD>EPSON Standard Code for Printers </DD>
<DT>FTP </DT>
<DD>File Transfer Protocol </DD>
<DT>HP-GL </DT>
<DD>Hewlett-Packard Graphics Language </DD>
<DT>HP-PCL </DT>
<DD>Hewlett-Packard Printer Control Language </DD>
<DT>HP-PJL </DT>
<DD>Hewlett-Packard Printer Job Language </DD>
<DT>IETF </DT>
<DD>Internet Engineering Task Force </DD>
<DT>IPP </DT>
<DD>Internet Printing Protocol </DD>
<DT>ISO </DT>
<DD>International Standards Organization </DD>
<DT>LPD </DT>
<DD>Line Printer Daemon </DD>
<DT>MIME </DT>
<DD>Multimedia Internet Mail Exchange </DD>
<DT>PCL </DT>
<DD>Page Control Language </DD>
<DT>PPD </DT>
<DD>PostScript Printer Description </DD>
<DT>SMB </DT>
<DD>Server Message Block </DD>
<DT>TFTP </DT>
<DD>Trivial File Transfer Protocol </DD>
</DL>
</BODY>
</HTML>
